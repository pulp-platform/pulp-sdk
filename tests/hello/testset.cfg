from gvtest.testsuite import *


def check_output(test, output, is_cluster):

    if is_cluster:
        if output.find('Hello from cluster_id: 0, core_id: 0') == -1:
            return (False, "Didn't find output string\n")
    else:
        if output.find('Hello from FC') == -1:
            return (False, "Didn't find output string\n")

    return (True, None)


# Called by gvtest to declare the tests
def testset_build(testset):

    #
    # Test list decription
    #
    testset.new_make_test('hello:fc', flags='build_dir_ext=fc', checker=lambda test, output: check_output(test, output, False))
    testset.new_make_test('hello:cl', flags='build_dir_ext=cl USE_CLUSTER=1', checker=lambda test, output: check_output(test, output, True))
